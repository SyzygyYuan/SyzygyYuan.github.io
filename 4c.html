<!doctype html>
<html>
<head>
<meta charset="utf-8">
<title>四除生成器</title>
</head>

<body>
	<input id="valText" value="不戴套不算艹"/><input id="valSize" type="number" size="3" style="width:6ex;" value="20"/>px<button id="btnGenerate">生成</button><button id="btnCopy">复制</button><div>
	<canvas id="myCanvas" width="496" height="409">
你的浏览器不支持canvas!
	</canvas></div>
	<img id="imgBg" src="4c.png" width="496" height="409" alt="" style="display:none;"/> <script type="text/javascript">
	var cav = document.getElementById('myCanvas');
	var btnGenerate = document.getElementById('btnGenerate');
	var btnCopy = document.getElementById('btnCopy');
	var valText = document.getElementById("valText");
	var valSize = document.getElementById("valSize");
	//var canvas = document.createElement('canvas');
	if(cav.getContext){
		var ctx = cav.getContext('2d');
		var img = document.getElementById("imgBg");
		img.onload = function() {
			btnGenerate.onclick = function(){
				ctx.drawImage(img,0,0);
				ctx.font=valSize.value.toString()+"px sans-serif";
				var h=ctx.measureText(valText.value).fontBoundingBoxAscent;
				ctx.fillText(valText.value,112,56+h,150);
			}
			btnGenerate.onclick()
		} 
		  btnCopy.onclick = () => {
		    cav.toBlob(async (blob) => {
		      console.log(blob);
		      const data = [
		        new ClipboardItem({
		          [blob.type]: blob,
		        }),
		      ]
		      await navigator.clipboard.write(data).then(
		        () => {
		          Message({
		            type: 'success',
		            message: "复制成功"
		          })
		          console.log("Copied to clipboard successfully!");
		        },
		        () => {
		          Message({
		            type: 'error',
		            message: "复制失败"
		          })
		          console.error("Unable to write to clipboard.");
		        }
		      );
		    });
		  };
		console.log("OK!");
	}else{
		console.log("Naze!");
	}
	</script>
</body>
</html>
